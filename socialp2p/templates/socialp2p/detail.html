{% extends 'base.html' %}
{% load staticfiles %}
{% load cloudinary %}
{% block body %}
<div class="container" id="container">
    <p>username: {{user_profile.username}}</p>
    <p data-qid="{{user_profile.author.uuid}}">id: {{user_profile.author.uuid}}</p>
    <p>host: {{user_profile.author.host}}</p>
    <p>url: {{user_profile.author.url}}</p>
    {% cloudinary user_profile.author.photo %}
    {% if not is_friend %}
        <form action="{% url 'api:friend_request' %}" method="POST" id="add">
            {% csrf_token %}
            <input type="submit" value="Add Friend" />
        </form>
	<script type='text/javascript'>
    	    $("#add").submit(function(event) {

      	        event.preventDefault();

   		var user_uuid = "{{user.author.uuid}}"
		var author_uuid = "{{user_profile.author.uuid}}"
      	        var $form = $( this ),
                    url = $form.attr( 'action' ); 	       
      	        $.ajax({
		    type:"POST", 
		    url,
		    data : {csrfmiddlewaretoken: document.getElementsByName('csrfmiddlewaretoken')[0].value, author : JSON.stringify(user_uuid), friend : JSON.stringify(author_uuid)},
    		    dataType : "json",
		    success: function( data ){
           	        alert('Added Friend');
    		    } 
	  	});
    	     });
	</script>
    {% endif %}
</div>
{% endblock %}
